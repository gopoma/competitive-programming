import sympy



public_key = (27145303911802224096045363137777486026895137234090943302783942648396342544966395831683718067223798756844820372965492650357203903100131927414169010531701419054182648928341934914840725290835084990712965063718048161416363522516507540391521153362539858543256776871825595194580717617596116346402148585135365921180620183851156666580045250995509733086982361540818968979, 35133662650488217617437225910867532022755320491493194382783791809362543816432473310621649268994697672219107450298440602172815188088948548540906928393560171303049868125281972318407088637077915158708575121725597144746471734231164218235070981074881289105663041967039907330415060826452899632654406913460093344984624752042088424095186074089397085090871078473878722291)
e, n = public_key
print(f"public_key:", public_key)



#factors = sympy.factorint(n)
#[p, q] = factors.keys()
#! TODO: DELETE
p = 4393867065127980038778480622230883256449789553905103537865906397747505074796209133960078957532014535850042148403343625115718895315202491124580055580751261229415531422073517532474647
q = 7996068640612112019537462947937934708548326296457020609141057450249274053693145783697216132929076334431979490310996845343372620135394683956690699705717606120515595240388229903378053
#! TODO: DELETE
n = p * q
phi = (p - 1) * (q - 1)
print(f"p: {p}")
print(f"q: {q}")
print(f"n: {n}")
print(f"phi: {phi}")



d = pow(e, -1, phi)
print(f"d: {d}")

private_key = (d, n)
print(f"private_key:", private_key)



def decrypt(ciphertext, private_key):
    d, n = private_key
    return ''.join(chr(pow(c, d, n)) for c in ciphertext)

cifrado = [11944249786104171242267318936025071923626976962405335267897766435629764459893785132208345950022510827993980959394176979269379285010802463625129277019950167686458522214030640705304810312553664274812761269116639653991254664247682574606825582719223665971699973635351984254730570579474744170607693127295701255610645523019577650226570471888240231184250946644889669191, 12339105647768449193766019822658684898671323303104887525558400688779584805870575643592421984448148151003412933266564827333166969797213279874364228760334475662532261807238972009392398980439173293931344005362390956785035402244458988517675574169003562889116759164242798992468752840011168332243439023562391249329266414781203486689827239138512699245345094872105009473, 19216486361876836465486632015465787930778748972851457455153494900360874444987142742083924496117384064743734696359984960547519147106430556982236250664763279044428628557326467014781811717977905426093571567231440899897797787960575747895685534926198409563182318406572708671940626657927621939921882772678014804058471878184140338621323066903334423093203264880064290586, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 25681456940019479648388428151778685397015502210282196500239675461699167746466426463606484354837932990121728893764424927146222306825073434423968216534897065545145014339816009036115899595495843850522492784911219466432723532786058885706965021980924311066726253583721829658268597463262968804112130145634881212717303413531967572808258526280324155997651666808963383694, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 12339105647768449193766019822658684898671323303104887525558400688779584805870575643592421984448148151003412933266564827333166969797213279874364228760334475662532261807238972009392398980439173293931344005362390956785035402244458988517675574169003562889116759164242798992468752840011168332243439023562391249329266414781203486689827239138512699245345094872105009473, 25681456940019479648388428151778685397015502210282196500239675461699167746466426463606484354837932990121728893764424927146222306825073434423968216534897065545145014339816009036115899595495843850522492784911219466432723532786058885706965021980924311066726253583721829658268597463262968804112130145634881212717303413531967572808258526280324155997651666808963383694, 32964021401311574595367346707659006368513043364975911562284283837625091632895647450263723706707071688506902937270047249254478945258276491281842297579360673785474381615176474135645283036373559519405494878602359768892861709829340674953645584234010168039515149803084893917520340251094265561199948616685646027816602410516313130737337970821779176005899008470148211872, 28916404812747744043261926991639313266728722976908002882414894070872101777327371821462990766989986117900389574471046849290077969709923094899840831030544559277253008379724335253970147369443751660804861398077621938368424665651417983293687178284109462224107886440529325742532557353435750744130927671577339909513203258813747074559252435039713889796010514645790116501, 25681456940019479648388428151778685397015502210282196500239675461699167746466426463606484354837932990121728893764424927146222306825073434423968216534897065545145014339816009036115899595495843850522492784911219466432723532786058885706965021980924311066726253583721829658268597463262968804112130145634881212717303413531967572808258526280324155997651666808963383694, 30373634994930263831541049099543238801392047692844725892118656669888481970766517743794543702872154231760621429762661788406251826949228153254086888097294567144249877214241618594795088858225211421800657222051533308345421318638026394503060706046138151025121171472898621071812845153050288304442376025907905992348023320538576869568408662985793330630268774851523314602, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 28916404812747744043261926991639313266728722976908002882414894070872101777327371821462990766989986117900389574471046849290077969709923094899840831030544559277253008379724335253970147369443751660804861398077621938368424665651417983293687178284109462224107886440529325742532557353435750744130927671577339909513203258813747074559252435039713889796010514645790116501, 12339105647768449193766019822658684898671323303104887525558400688779584805870575643592421984448148151003412933266564827333166969797213279874364228760334475662532261807238972009392398980439173293931344005362390956785035402244458988517675574169003562889116759164242798992468752840011168332243439023562391249329266414781203486689827239138512699245345094872105009473, 19875696174553420469738711695175281922250372238038488836921902650438836960181981266770809236690373626415927265383161854749376549001504743699312485204323417523452658857750678433424765199505967044824363958147997015241976094761107928823069872685285740380822994285014642427005947622765055018956370192825527244231094473504945403421213108163701300918801578136610119088, 24388155070036125975567507065068797135142824999593386806610763566583024857182426952877111531283654551168634881239300798948077777369060339222636301856914234656687574127265013468930362915456158249934640414354747649142747997569764485435704407735496099292822112659858551296307021049151317426687351424698573911956328741211721588651984342321264357743253790777585195428, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 25681456940019479648388428151778685397015502210282196500239675461699167746466426463606484354837932990121728893764424927146222306825073434423968216534897065545145014339816009036115899595495843850522492784911219466432723532786058885706965021980924311066726253583721829658268597463262968804112130145634881212717303413531967572808258526280324155997651666808963383694, 12339105647768449193766019822658684898671323303104887525558400688779584805870575643592421984448148151003412933266564827333166969797213279874364228760334475662532261807238972009392398980439173293931344005362390956785035402244458988517675574169003562889116759164242798992468752840011168332243439023562391249329266414781203486689827239138512699245345094872105009473, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 19064024744526342769997589104109778971828404547922046225235132875188077907945614393085277949997561209370976312335092552571047046017678639875064285408752228058236133412798247983068512013217237198176491990443913788957051159178943627913823699708319622787899121489263585810457189064672801242272183859280168152378682746890274297634462040421835487098817167297269994750, 28751894166330193387391884177254236962899635389070117277870565718118476284176350820152014447594059883975830496183558719901041328909931026469394798372802779003063056041414901099834929248765586514184939846567748603113218400019236849242622640443256078542000518339673819726018828117151087311180993178714009857679726834010297365996942920200209916850185719699445937378, 3144445134070635707686166995348687752786662697887625789087840160854900302017984241595219107256412411467262684319986288421907915329441579179037485408748057754409095820715798197217654090482128355245035332449451043248161074604149173659402930039675022052675792136462233465486820022138453294734355414992027845599148916182609656613583349288539517417467669821029329044, 19216486361876836465486632015465787930778748972851457455153494900360874444987142742083924496117384064743734696359984960547519147106430556982236250664763279044428628557326467014781811717977905426093571567231440899897797787960575747895685534926198409563182318406572708671940626657927621939921882772678014804058471878184140338621323066903334423093203264880064290586, 2693241466402137878644627570059577389189139643714191296201283160927044212793251898919223302703542118123740855977941439638456213118606199929886698149786676808441360680197664812076559465392920384474799011300580118701063222981814719843291387063847581735671860340130612351038709909865123445836832303740241025709212370135379460699456241150807927360938576385818308022]
print("Mensaje cifrado:", cifrado)

descifrado = decrypt(cifrado, private_key)
print("Mensaje descifrado:", descifrado)
